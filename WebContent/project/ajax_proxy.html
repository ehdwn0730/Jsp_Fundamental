<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title></title>
     <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
	<!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="/js/jquery-3.5.1.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    
    <script type = "text/javascript" src = "../js/jquery-3.5.1.js"></script>
	 <script type="text/javascript"></script>   
	 
	<style>
	table{
	background-color : #FAFAAA;
	}
	</style>
</head>
<body>
    <script>
        //버튼을 누르면 데이터를 가져올 수 있는 작성문
        $(function(){
   
        	$('#searchbox').keydown(function(key){
        		//keyCode = enter ==> 엔터치면 button태그의 id인 search의 click 이벤트가 발생
        		if(key.keyCode == 13){
        			$('#search').trigger("click");
        		}
        	
        	});
        	
        	$('#search').bind('click',function(){
               
            	//input 입력값 변수에 넣기
            	var searching = $("#searchbox").val();
            	//서울특별시 강남구로 입력한 경우 공백 기준으로 문자열 쪼개기
            	//강남구만 입력한 경우 쪼개지 않음
            	if(searching.includes(' ')){
            		var searching_split = searching.split(' ');
            		var searching2 = searching_split[1];
            	}else{
            		var searching2 = searching;
            	}
            	
            	
            	$.ajax({
                   url : 'proxy.jsp?url=http://openapi.seoul.go.kr:8088/5246785571717365353246414c496f/xml/vtrHospitalInfo/1/1000/',
                   type : 'GET',
                   dataType : 'xml',
                   error : function(){
                       alert('error');
                   },
                   success : function(xml){
                	   
                	   $('#content2').empty();//empty(): 자식 요소(자손까지 포함)뿐만 아니라
                	   							//일치하는 요소 내의 텍스트를 지운다.
                	   
                	   //console.log(xml);
                	   //text() 함수는 선택한 요소 안의 내용을 가져오거나, 다른 내용으로 바꾸는 메서드
                	   //each:object와 배열 모두에서 사용할 수 있는 반복함수
                	   //row열에서 들어와서 지도명 주소의 무슨 구인지를 text함수로 찾아서 변수로 저장
                	   
                	   var msg = "";
                	   
                	   msg += "<div class = 'table-rsponsive-md'>";
                	   msg += "<table class = 'table table-bordered table-hover'>";
                	   msg += "<thead class = thead>";
                	   msg += "<tr>";
                	   msg += "<th>이름</th>";
                	   msg += "<th>주소</th>";
                	   msg += "<th>전화번호</th>";
                	   msg += "<th>운영 상태</th>"
                	   //msg += "<th>위도</th>";
                	   //msg += "<th>경도</th>";
                	   msg += "</tr>";
                	   msg += "</thead>";
                	   	
	                	   	$(xml).find("row").each(function(){
	                	   		//입력값과 비교할 변수
		                	   	let ADDR = $(this).find("ADDR").text();
	                	   		if(ADDR.includes(searching2)){
		                		let NM = $(this).find("NM").text();
		                	   	let TEL = $(this).find("TEL").text();
		                	   	let STATE = $(this).find("STATE").text();		                	   
		                	   	//let XCODE = $(this).find("XCODE").text();
		                	   	//let YCODE = $(this).find("YCODE").text();
		                	   	msg += "<tbody>";
		                	   	msg += "<tr>";
		                	   	msg += "<td>"+NM+"</td>";
		                	   	msg += "<td>"+ADDR+"</td>";
		                	   	msg += "<td>"+TEL+"</td>";
		                	   	msg += "<td>"+STATE+"</td>";		                	   	
		                	   	//msg += "<td>+XCODE+</td>";
		                	   	//msg += "<td>+YCODE+</td>";
		                	   	msg += "</tr>";
		                	   	msg += "</tbody>";
	                	   		}else{
	                	   			
	                	   		}
					  	});
	                	   	msg += "</table>";
	                	   	msg += "</div>";
	                	   	$('#content2').append(msg);
                   }
               });
              });
        });

    </script>
    <div class = "container" >
   
    	<div class = "row" style = "margin-top:20px">
    		<div class = "col-sm-12">
    			<h3 class = "card-title">서울특별시 동물병원</h3>
    			<div class = "form-row d-flex align-items-center">
    			  <img src = "main_banner_01.jpg" class = "check1" alt="Responsive image" title>
    			<div class = "form-group col-md-10">
    				<input type = "text" id = "searchbox" name = "searchbox"
    				class = "form-control" placeholder = "예)양천구"/>
    			</div>
    			<div class = "form-group col-md-2">
    				<button id = "search" class = "btn btn-info btn-lg btn-block">찾기</button>
    			</div>
    			</div>
    		</div>
    	</div>
    	<p> 검색 예) 서울특별시 양천구 or 양천구</p>
    	<div class = "row" style = "margin-top:20px">
    		<div class = "col-sm-12">
    		
    		</div>
    		</div>
    		<div class = "row">
    			<div class = "col-sm-12" id = "content2">
    			
    			</div>
    		
    		</div>
    </div>
    
    
    
</body>
</html>